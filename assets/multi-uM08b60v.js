import{L as m}from"./lobby-DR5AaX3T.js";const p="https://chbibdnqynilfuczbygg.supabase.co",u="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNoYmliZG5xeW5pbGZ1Y3pieWdnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ3MDc0OTQsImV4cCI6MjA3MDI4MzQ5NH0.VuwTKXiU1Yx4C_fQCIp5X20m8SupxBkCKhQzN7Vqe20",s=new m(p,u),a=document.getElementById("room-list");s.onUpdate=o=>{if(a){if(!o.length){a.innerHTML='<div class="muted" id="room-empty" style="grid-column:1/-1;display:flex;flex-direction:column;gap:12px;align-items:center;justify-content:center;padding:36px 12px;text-align:center;">현재 대기중인 방이 없습니다.<br/><button id="room-empty-create">방 만들기</button></div>';const e=document.getElementById("room-empty-create");e&&e.addEventListener("click",()=>{var n;const t=document.getElementById("room-title");t instanceof HTMLInputElement&&(t.focus(),(n=t.select)==null||n.call(t))});return}a.innerHTML=o.map(e=>`<button class="card" data-join="${e.id}" style="display:flex;flex-direction:column;justify-content:space-between;text-align:left;padding:16px;height:110px;background:#0f142f;border:1px solid #2a2f66;border-radius:12px;color:inherit;cursor:pointer;"><div style="font-weight:700;font-size:14px;">${e.title||"Room"}</div><div style="display:flex;justify-content:space-between;font-size:12px;color:#9aa0c3;"><span>${e.host}</span><span>${e.players}/${e.max}</span></div></button>`).join(""),a.querySelectorAll("button[data-join]").forEach(e=>e.addEventListener("click",t=>{const n=t.currentTarget,i=n&&n.dataset?n.dataset.join:null;i&&(localStorage.setItem("tetris_room",i),window.location.href="./game.html")}))}};const d=localStorage.getItem("tetris_nick")||"";d?s.join(d):y();function y(){const o=document.createElement("div");o.style.cssText="position:fixed;inset:0;background:rgba(0,0,0,0.5);display:grid;place-items:center;z-index:2000;";const e=document.createElement("div");e.className="panel",e.style.cssText="width:min(480px,92vw);",e.innerHTML='<h2 style="margin:0 0 8px;">닉네임 설정</h2><p class="muted" style="margin:0 0 8px;">게임에서 표시될 이름을 입력하세요.</p>';const t=document.createElement("div");t.className="row";const n=document.createElement("input");n.className="input",n.placeholder="Nickname",n.style.flex="1 1 auto";const i=document.createElement("button");i.textContent="확인",t.appendChild(n),t.appendChild(i),e.appendChild(t),o.appendChild(e),document.body.appendChild(o),n.focus();function l(){const c=(n.value||"").trim()||"Anonymous";localStorage.setItem("tetris_nick",c),s.join(c),document.body.removeChild(o)}i.addEventListener("click",l),n.addEventListener("keydown",c=>{c.key==="Enter"&&l()})}const r=document.getElementById("btn-create");r&&r.addEventListener("click",()=>{const o=document.getElementById("room-title"),e=(o instanceof HTMLInputElement?o.value:"").trim();if(!e){alert("방 제목을 입력하세요"),o instanceof HTMLInputElement&&o.focus();return}const t=s.createRoom(e);localStorage.setItem("tetris_room",t),window.location.href="./game.html"});
